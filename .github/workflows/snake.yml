name: Generate GitHub Snake

on:
  schedule:
    - cron: "0 0 * * *"  # Запуск каждый день в полночь по UTC
  workflow_dispatch:     # Возможность запустить вручную
  push:
    branches: [main, master]  # Поддержка обеих веток

permissions:
  contents: write  # КРИТИЧЕСКИ ВАЖНО: даём права на запись в репозиторий

jobs:
  generate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}  # Используем системный токен с правами

      - name: Generate snake animation
        uses: Platane/snk@v3
        with:
          github_user_name: Kapusta3
          outputs: |
            dist/snake.svg
            dist/snake-dark.svg?palette=github-dark

      - name: Commit and push
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore: update snake animation"
          file_pattern: dist/*.svg
          branch: ${{ github.ref_name }}  # Автоматический выбор текущей ветки
